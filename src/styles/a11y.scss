/* Accessibility Styles */
/* Applied via data-a11y attribute on html element */

/* Reduce Motion */
html[data-a11y~='reduce-motion'] {
  /* Override CSS variable transitions */
  --transition-fast: 0ms;
  --transition-normal: 0ms;
  --transition-slow: 0ms;
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* High Contrast */
html[data-a11y~='contrast-high'] {
  filter: contrast(1.15) brightness(1.05) saturate(1.05);

  /* Enhance border visibility */
  * {
    border-width: max(1px, var(--border-width, 1px));
  }

  /* Make focus indicators more prominent */
  :focus-visible {
    outline: 3px solid var(--color-primary) !important;
    outline-offset: 2px !important;
  }

  /* Enhance button contrast */
  button,
  [role='button'] {
    border: 2px solid var(--border-primary) !important;

    &:hover {
      border-color: var(--color-primary) !important;
    }
  }

  /* Enhance form input contrast */
  input,
  select,
  textarea {
    border: 2px solid var(--border-primary) !important;

    &:focus {
      border-color: var(--color-primary) !important;
    }
  }
}

/* Dark Mode High Contrast */
html[data-a11y~='dark-contrast-high'] {
  --bg-primary: #000000;
  --bg-secondary: #0a0a0a;
  --bg-tertiary: #141414;
  --text-primary: #ffffff;
  --text-secondary: #e0e0e0;
  --border-primary: #404040;
  --border-secondary: #606060;
}

/* Large Text Scale */
html[data-a11y~='scale-large'] {
  font-size: 110%; /* Increase base font size by 25% */

  /* Scale specific font size variables */
  --font-size-2xs: 0.75rem;
  --font-size-xs: 0.9375rem;
  --font-size-sm: 1.09375rem;
  --font-size-md: 1.25rem;
  --font-size-lg: 1.40625rem;
  --font-size-xl: 1.5625rem;
  --font-size-2xl: 1.875rem;
  --font-size-3xl: 2.5rem;

  /* Scale spacing for better proportion */
  --spacing-xs: 0.3125rem;
  --spacing-sm: 0.625rem;
  --spacing-md: 1.25rem;
  --spacing-lg: 1.875rem;
  --spacing-xl: 2.5rem;
  --spacing-2xl: 3.75rem;

  /* Ensure line height remains readable */
  * {
    line-height: 1.6;
  }

  /* Scale icon sizes appropriately */
  .icon {
    &.w-2 {
      width: 0.625rem;
      height: 0.625rem;
    }
    &.w-4 {
      width: 1.25rem;
      height: 1.25rem;
    }
    &.w-6 {
      width: 1.875rem;
      height: 1.875rem;
    }
    &.w-8 {
      width: 2.5rem;
      height: 2.5rem;
    }
  }
}

/* Dyslexia-Friendly Font */
html[data-a11y~='dyslexia-font'] {
  /* Import OpenDyslexic font when needed */
  @import url('https://fonts.cdnfonts.com/css/opendyslexic');

  font-family: 'OpenDyslexic', 'Comic Sans MS', 'Trebuchet MS', 'Verdana', sans-serif;
  letter-spacing: 0.05em;
  line-height: 1.6;

  *,
  h1,
  h2,
  h3,
  h4,
  h5,
  h6,
  p,
  span,
  div,
  li,
  td,
  th {
    font-family: inherit;
    letter-spacing: inherit;
  }

  code,
  pre,
  .font-mono,
  [class*='mono'] {
    font-family: var(--font-mono);
    letter-spacing: 0.02em;
  }
}

/* Always Underline Links */
html[data-a11y~='links-always-underline'] {
  a {
    text-decoration: underline !important;
    text-underline-offset: 0.2em;
    text-decoration-thickness: 1px;

    &:hover {
      text-decoration-thickness: 2px;
    }
  }

  /* Exception for button-styled links */
  a[role='button'],
  a.btn,
  a.button {
    text-decoration: none !important;
  }
}

/* Hide Decorative Icons */
html[data-a11y~='no-icons'] {
  /* Hide decorative icons but keep essential ones */
  .icon:not([aria-label]):not([role]):not([aria-hidden='false']) {
    display: none !important;
  }

  /* Hide background images that are decorative */
  .bg-pattern,
  .decorative-bg {
    background-image: none !important;
  }

  /* Ensure buttons still work without icons by adding text */
  button:not([aria-label]):has(.icon:only-child):after {
    content: attr(title);
    margin-left: var(--spacing-xs);
  }
}

/* Enhanced Focus Indicators */
html[data-a11y~='focus-enhanced'] {
  :focus-visible {
    outline: 3px solid var(--color-primary) !important;
    outline-offset: 3px !important;
    border-radius: var(--radius-sm);
    box-shadow:
      0 0 0 1px var(--bg-primary),
      0 0 0 4px var(--color-primary) !important;
  }

  /* High contrast focus for form elements */
  input:focus-visible,
  textarea:focus-visible,
  select:focus-visible {
    box-shadow:
      0 0 0 1px var(--bg-primary),
      0 0 0 4px var(--color-primary),
      inset 0 0 0 2px var(--color-primary) !important;
  }

  /* Focus for custom controls */
  [role='button']:focus-visible,
  [role='switch']:focus-visible,
  [role='checkbox']:focus-visible,
  [role='radio']:focus-visible {
    outline: 3px solid var(--color-primary) !important;
    outline-offset: 2px !important;
  }

  /* Skip links become visible on focus */
  .skip-link:focus {
    position: absolute !important;
    top: var(--spacing-md) !important;
    left: var(--spacing-md) !important;
    z-index: 9999 !important;
    padding: var(--spacing-sm) var(--spacing-md) !important;
    background: var(--bg-secondary) !important;
    border: 2px solid var(--color-primary) !important;
    border-radius: var(--radius-sm) !important;
    color: var(--text-primary) !important;
    text-decoration: none !important;
    font-weight: 600;
    box-shadow: var(--shadow-lg) !important;
  }
}

/* Prefers Reduced Motion - System Preference Override */
@media (prefers-reduced-motion: reduce) {
  html:not([data-a11y~='reduce-motion']) {
    * {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
      scroll-behavior: auto !important;
    }
  }
}

/* Prefers High Contrast - System Preference Support */
@media (prefers-contrast: high) {
  html:not([data-a11y~='contrast-high']) {
    filter: contrast(1.1) brightness(1.02);
  }
}

/* Large Text System Preference */
@media (prefers-reduced-data: reduce) {
  /* Reduce background images when user prefers reduced data */
  html {
    .bg-pattern,
    .decorative-bg {
      background-image: none !important;
    }
  }
}

/* Color Scheme Preference Support */
@media (prefers-color-scheme: dark) {
  html[data-a11y~='dark-contrast-high'] {
    --bg-primary: #000000;
    --text-primary: #ffffff;
  }
}

/* Print Accessibility */
@media print {
  html[data-a11y] {
    /* Ensure high contrast for printing */
    filter: none !important;

    /* Force black text on white background */
    * {
      background: white !important;
      color: black !important;
      box-shadow: none !important;
      text-shadow: none !important;
    }

    /* Show link URLs */
    a:after {
      content: ' (' attr(href) ')';
      font-size: 0.8em;
      color: #666;
    }

    /* Hide decorative elements */
    .icon:not([aria-label]) {
      display: none !important;
    }
  }
}

/* Focus management for screen readers */
.sr-only {
  position: absolute !important;
  width: 1px !important;
  height: 1px !important;
  padding: 0 !important;
  margin: -1px !important;
  overflow: hidden !important;
  clip: rect(0, 0, 0, 0) !important;
  white-space: nowrap !important;
  border: 0 !important;
}

.sr-only-focusable:focus {
  position: static !important;
  width: auto !important;
  height: auto !important;
  padding: inherit !important;
  margin: inherit !important;
  overflow: visible !important;
  clip: auto !important;
  white-space: inherit !important;
}

/* Skip links */
.skip-link {
  position: absolute;
  top: -40px;
  left: 6px;
  background: var(--bg-primary);
  color: var(--text-primary);
  padding: 8px;
  border: 1px solid var(--border-primary);
  border-radius: var(--radius-sm);
  text-decoration: none;
  z-index: 1000;
  transition: top 0.3s;

  &:focus {
    top: 6px;
  }
}
